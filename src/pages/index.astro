---
import MainLayout from '../layouts/MainLayout.astro'
import SearchForm from '../components/SearchForm.astro'
import MostRecentArticle from '../components/MostRecentArticle.astro'
import ArticleCard from '../components/ArticleCard.astro'
import { HOMEPAGE_ARTICLE_LIMIT } from '../constants'
import { getCollection } from 'astro:content'
import type { CollectionEntry } from 'astro:content'
const allBlogArticles: CollectionEntry<'blog'>[] = (
  await getCollection('blog')
).sort(
  (a: CollectionEntry<'blog'>, b: CollectionEntry<'blog'>) =>
    b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
)
const mostRecentArticle: CollectionEntry<'blog'> = allBlogArticles[0]
const otherArticles: CollectionEntry<'blog'>[] = allBlogArticles.slice(1)
---

<MainLayout>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
    <div>
      <h1 class="text-5xl font-bold mt-4 mb-8 leading-tight xl:text-6xl">
        Articles, Stories & Tutorials for Tech People
      </h1>
      <SearchForm />
    </div>
    <MostRecentArticle article={mostRecentArticle} />
  </div>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
    {
      otherArticles
        .slice(0, HOMEPAGE_ARTICLE_LIMIT)
        .map((article) => <ArticleCard article={article} />)
    }
  </div>
</MainLayout>
